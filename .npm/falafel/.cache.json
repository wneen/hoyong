{"_id":"falafel","_rev":"37-a7264889daa31eb71d553880a66cfb25","name":"falafel","description":"transform the ast on a recursive walk","dist-tags":{"latest":"0.3.1"},"versions":{"0.0.0":{"name":"falafel","description":"transform the ast on a recursive walk","version":"0.0.0","repository":{"type":"git","url":"git://github.com/substack/node-falafel.git"},"main":"index.js","keywords":["ast","source","traversal","syntax","tree","burrito"],"directories":{"example":"example","test":"test"},"scripts":{"test":"tap test/*.js"},"dependencies":{"esprima":"~0.9.9"},"devDependencies":{"tap":"~0.2.4"},"engines":{"node":">=0.4.0"},"license":"MIT","author":{"name":"James Halliday","email":"mail@substack.net","url":"http://substack.net"},"_npmUser":{"name":"substack","email":"mail@substack.net"},"_id":"falafel@0.0.0","optionalDependencies":{},"_engineSupported":true,"_npmVersion":"1.1.1","_nodeVersion":"v0.6.11","_defaultsLoaded":true,"dist":{"shasum":"724f3edfcab3a4d429c1e2da86fecd790255c76b","tarball":"http://registry.npmjs.org/falafel/-/falafel-0.0.0.tgz"},"maintainers":[{"name":"substack","email":"mail@substack.net"}]},"0.0.1":{"name":"falafel","description":"transform the ast on a recursive walk","version":"0.0.1","repository":{"type":"git","url":"git://github.com/substack/node-falafel.git"},"main":"index.js","keywords":["ast","source","traversal","syntax","tree","burrito"],"directories":{"example":"example","test":"test"},"scripts":{"test":"tap test/*.js"},"dependencies":{"esprima":"~0.9.9"},"devDependencies":{"tap":"~0.2.4"},"engines":{"node":">=0.4.0"},"license":"MIT","author":{"name":"James Halliday","email":"mail@substack.net","url":"http://substack.net"},"_npmUser":{"name":"substack","email":"mail@substack.net"},"_id":"falafel@0.0.1","optionalDependencies":{},"_engineSupported":true,"_npmVersion":"1.1.1","_nodeVersion":"v0.6.11","_defaultsLoaded":true,"dist":{"shasum":"732a9d157fdbe548f5c06fc078c8953ef8fdf11e","tarball":"http://registry.npmjs.org/falafel/-/falafel-0.0.1.tgz"},"maintainers":[{"name":"substack","email":"mail@substack.net"}]},"0.0.2":{"name":"falafel","description":"transform the ast on a recursive walk","version":"0.0.2","repository":{"type":"git","url":"git://github.com/substack/node-falafel.git"},"main":"index.js","keywords":["ast","source","traversal","syntax","tree","burrito"],"directories":{"example":"example","test":"test"},"scripts":{"test":"tap test/*.js"},"dependencies":{"esprima":"~0.9.9"},"devDependencies":{"tap":"~0.2.4"},"engines":{"node":">=0.4.0"},"license":"MIT","author":{"name":"James Halliday","email":"mail@substack.net","url":"http://substack.net"},"_npmUser":{"name":"substack","email":"mail@substack.net"},"_id":"falafel@0.0.2","optionalDependencies":{},"_engineSupported":true,"_npmVersion":"1.1.19","_nodeVersion":"v0.6.11","_defaultsLoaded":true,"dist":{"shasum":"a4e6870f122e39fee0c3cab9ce3273f2adadd5b6","tarball":"http://registry.npmjs.org/falafel/-/falafel-0.0.2.tgz"},"maintainers":[{"name":"substack","email":"mail@substack.net"}]},"0.1.0":{"name":"falafel","description":"transform the ast on a recursive walk","version":"0.1.0","repository":{"type":"git","url":"git://github.com/substack/node-falafel.git"},"main":"index.js","keywords":["ast","source","traversal","syntax","tree","burrito"],"directories":{"example":"example","test":"test"},"scripts":{"test":"tap test/*.js"},"dependencies":{"esprima":"~0.9.9"},"devDependencies":{"tap":"~0.2.4"},"engines":{"node":">=0.4.0"},"license":"MIT","author":{"name":"James Halliday","email":"mail@substack.net","url":"http://substack.net"},"_npmUser":{"name":"substack","email":"mail@substack.net"},"_id":"falafel@0.1.0","optionalDependencies":{},"_engineSupported":true,"_npmVersion":"1.1.19","_nodeVersion":"v0.6.11","_defaultsLoaded":true,"dist":{"shasum":"f132f5138cf6b1ac50ff1c16066eed26f0c7446d","tarball":"http://registry.npmjs.org/falafel/-/falafel-0.1.0.tgz"},"maintainers":[{"name":"substack","email":"mail@substack.net"}]},"0.1.1":{"name":"falafel","description":"transform the ast on a recursive walk","version":"0.1.1","repository":{"type":"git","url":"git://github.com/substack/node-falafel.git"},"main":"index.js","keywords":["ast","source","traversal","syntax","tree","burrito"],"directories":{"example":"example","test":"test"},"scripts":{"test":"tap test/*.js"},"dependencies":{"esprima":"~0.9.9"},"devDependencies":{"tap":"~0.2.4"},"engines":{"node":">=0.4.0"},"license":"MIT","author":{"name":"James Halliday","email":"mail@substack.net","url":"http://substack.net"},"_id":"falafel@0.1.1","dist":{"shasum":"6120136d2fb24010bc066db8b982201596fd1d67","tarball":"http://registry.npmjs.org/falafel/-/falafel-0.1.1.tgz"},"maintainers":[{"name":"substack","email":"mail@substack.net"}]},"0.1.2":{"name":"falafel","description":"transform the ast on a recursive walk","version":"0.1.2","repository":{"type":"git","url":"git://github.com/substack/node-falafel.git"},"main":"index.js","keywords":["ast","source","traversal","syntax","tree","burrito"],"directories":{"example":"example","test":"test"},"scripts":{"test":"tap test/*.js"},"dependencies":{"esprima":"~0.9.9"},"devDependencies":{"tap":"~0.2.4"},"engines":{"node":">=0.4.0"},"license":"MIT","author":{"name":"James Halliday","email":"mail@substack.net","url":"http://substack.net"},"_id":"falafel@0.1.2","dist":{"shasum":"d0c851941da898762a5b5aa208d963d10b3d683e","tarball":"http://registry.npmjs.org/falafel/-/falafel-0.1.2.tgz"},"maintainers":[{"name":"substack","email":"mail@substack.net"}]},"0.1.3":{"name":"falafel","description":"transform the ast on a recursive walk","version":"0.1.3","repository":{"type":"git","url":"git://github.com/substack/node-falafel.git"},"main":"index.js","keywords":["ast","source","traversal","syntax","tree","burrito"],"directories":{"example":"example","test":"test"},"scripts":{"test":"tap test/*.js"},"dependencies":{"esprima":"~0.9.9"},"devDependencies":{"tap":"~0.2.4"},"engines":{"node":">=0.4.0"},"license":"MIT","author":{"name":"James Halliday","email":"mail@substack.net","url":"http://substack.net"},"_id":"falafel@0.1.3","dist":{"shasum":"becb2f558f6548543cf0db6f89569f766d5c96ac","tarball":"http://registry.npmjs.org/falafel/-/falafel-0.1.3.tgz"},"maintainers":[{"name":"substack","email":"mail@substack.net"}]},"0.1.4":{"name":"falafel","description":"transform the ast on a recursive walk","version":"0.1.4","repository":{"type":"git","url":"git://github.com/substack/node-falafel.git"},"main":"index.js","keywords":["ast","source","traversal","syntax","tree","burrito"],"directories":{"example":"example","test":"test"},"scripts":{"test":"tap test/*.js"},"dependencies":{"esprima":"1.0.0"},"devDependencies":{"tap":"~0.2.4"},"engines":{"node":">=0.4.0"},"license":"MIT","author":{"name":"James Halliday","email":"mail@substack.net","url":"http://substack.net"},"testling":{"files":"test/for.js","browsers":{"iexplore":["9.0"],"chrome":["20.0"],"firefox":["13.0"],"safari":["5.1"],"opera":["11.6"]}},"_id":"falafel@0.1.4","dist":{"shasum":"dd228dd165a1559d0dc93f533c4b63b59396a6e9","tarball":"http://registry.npmjs.org/falafel/-/falafel-0.1.4.tgz"},"_npmVersion":"1.1.59","_npmUser":{"name":"substack","email":"mail@substack.net"},"maintainers":[{"name":"substack","email":"mail@substack.net"}]},"0.1.5":{"name":"falafel","description":"transform the ast on a recursive walk","version":"0.1.5","repository":{"type":"git","url":"git://github.com/substack/node-falafel.git"},"main":"index.js","keywords":["ast","source","traversal","syntax","tree","burrito"],"directories":{"example":"example","test":"test"},"scripts":{"test":"tap test/*.js"},"dependencies":{"esprima":"~1.0.2"},"devDependencies":{"tape":"~0.0.2","tap":"~0.3.0"},"engines":{"node":">=0.4.0"},"license":"MIT","author":{"name":"James Halliday","email":"mail@substack.net","url":"http://substack.net"},"testling":{"files":"test/*.js","browsers":{"iexplore":["6.0","7.0","8.0","9.0"],"chrome":["20.0"],"firefox":["10.0","15.0"],"safari":["5.1"],"opera":["12.0"]}},"_id":"falafel@0.1.5","dist":{"shasum":"da0c19518e73e7ddfe187c50556200b580841f1c","tarball":"http://registry.npmjs.org/falafel/-/falafel-0.1.5.tgz"},"_from":".","_npmVersion":"1.2.2","_npmUser":{"name":"substack","email":"mail@substack.net"},"maintainers":[{"name":"substack","email":"mail@substack.net"}]},"0.1.6":{"name":"falafel","description":"transform the ast on a recursive walk","version":"0.1.6","repository":{"type":"git","url":"git://github.com/substack/node-falafel.git"},"main":"index.js","keywords":["ast","source","traversal","syntax","tree","burrito"],"directories":{"example":"example","test":"test"},"scripts":{"test":"tap test/*.js"},"dependencies":{"esprima":"~1.0.2"},"devDependencies":{"tape":"~0.0.2","tap":"~0.3.0"},"engines":{"node":">=0.4.0"},"license":"MIT","author":{"name":"James Halliday","email":"mail@substack.net","url":"http://substack.net"},"testling":{"files":"test/*.js","browsers":{"iexplore":["6.0","7.0","8.0","9.0"],"chrome":["20.0"],"firefox":["10.0","15.0"],"safari":["5.1"],"opera":["12.0"]}},"_id":"falafel@0.1.6","dist":{"shasum":"3084cf3d41b59d15c813be6f259557fdc82b0660","tarball":"http://registry.npmjs.org/falafel/-/falafel-0.1.6.tgz"},"_from":".","_npmVersion":"1.2.2","_npmUser":{"name":"substack","email":"mail@substack.net"},"maintainers":[{"name":"substack","email":"mail@substack.net"}]},"0.2.0":{"name":"falafel","description":"transform the ast on a recursive walk","version":"0.2.0","repository":{"type":"git","url":"git://github.com/substack/node-falafel.git"},"main":"index.js","keywords":["ast","source","traversal","syntax","tree","burrito"],"directories":{"example":"example","test":"test"},"scripts":{"test":"tap test/*.js"},"dependencies":{"esprima":"git://github.com/substack/esprima.git#is-keyword"},"devDependencies":{"tape":"~0.0.2","tap":"~0.3.0"},"engines":{"node":">=0.4.0"},"license":"MIT","author":{"name":"James Halliday","email":"mail@substack.net","url":"http://substack.net"},"testling":{"files":"test/*.js","browsers":{"iexplore":["6.0","7.0","8.0","9.0"],"chrome":["20.0"],"firefox":["10.0","15.0"],"safari":["5.1"],"opera":["12.0"]}},"_id":"falafel@0.2.0","dist":{"shasum":"b4434b659aa00ddbaace40efb9ad1f4ede36eb4f","tarball":"http://registry.npmjs.org/falafel/-/falafel-0.2.0.tgz"},"_from":".","_npmVersion":"1.2.2","_npmUser":{"name":"substack","email":"mail@substack.net"},"maintainers":[{"name":"substack","email":"mail@substack.net"}]},"0.2.1":{"name":"falafel","description":"transform the ast on a recursive walk","version":"0.2.1","repository":{"type":"git","url":"git://github.com/substack/node-falafel.git"},"main":"index.js","keywords":["ast","source","traversal","syntax","tree","burrito"],"directories":{"example":"example","test":"test"},"scripts":{"test":"tap test/*.js"},"dependencies":{"esprima":"substack/esprima#is-keyword"},"devDependencies":{"tape":"~0.0.2","tap":"~0.3.0"},"engines":{"node":">=0.4.0"},"license":"MIT","author":{"name":"James Halliday","email":"mail@substack.net","url":"http://substack.net"},"testling":{"files":"test/*.js","browsers":{"iexplore":["6.0","7.0","8.0","9.0"],"chrome":["20.0"],"firefox":["10.0","15.0"],"safari":["5.1"],"opera":["12.0"]}},"_id":"falafel@0.2.1","dist":{"shasum":"9efc51ce19ec5729086b22ae889e5d7d0e256601","tarball":"http://registry.npmjs.org/falafel/-/falafel-0.2.1.tgz"},"_from":".","_npmVersion":"1.2.2","_npmUser":{"name":"substack","email":"mail@substack.net"},"maintainers":[{"name":"substack","email":"mail@substack.net"}]},"0.3.0":{"name":"falafel","description":"transform the ast on a recursive walk","version":"0.3.0","repository":{"type":"git","url":"git://github.com/substack/node-falafel.git"},"main":"index.js","keywords":["ast","source","traversal","syntax","tree","burrito"],"directories":{"example":"example","test":"test"},"scripts":{"test":"tape test/*.js"},"devDependencies":{"tape":"~1.0.4"},"engines":{"node":">=0.4.0"},"license":"MIT","author":{"name":"James Halliday","email":"mail@substack.net","url":"http://substack.net"},"testling":{"files":"test/*.js","browsers":{"iexplore":["6.0","7.0","8.0","9.0"],"chrome":["20.0"],"firefox":["10.0","15.0"],"safari":["5.1"],"opera":["12.0"]}},"bugs":{"url":"https://github.com/substack/node-falafel/issues"},"bundleDependencies":["esprima"],"_id":"falafel@0.3.0","dist":{"shasum":"3dcd21463382796d7a322b55196fe25a1d4dcb0a","tarball":"http://registry.npmjs.org/falafel/-/falafel-0.3.0.tgz"},"_from":".","_npmVersion":"1.3.0","_npmUser":{"name":"substack","email":"mail@substack.net"},"maintainers":[{"name":"substack","email":"mail@substack.net"}]},"0.3.1":{"name":"falafel","description":"transform the ast on a recursive walk","version":"0.3.1","repository":{"type":"git","url":"git://github.com/substack/node-falafel.git"},"main":"index.js","keywords":["ast","source","traversal","syntax","tree","burrito"],"directories":{"example":"example","test":"test"},"scripts":{"test":"tape test/*.js"},"devDependencies":{"tape":"~1.0.4"},"engines":{"node":">=0.4.0"},"license":"MIT","author":{"name":"James Halliday","email":"mail@substack.net","url":"http://substack.net"},"testling":{"files":"test/*.js","browsers":{"iexplore":["6.0","7.0","8.0","9.0"],"chrome":["20.0"],"firefox":["10.0","15.0"],"safari":["5.1"],"opera":["12.0"]}},"bugs":{"url":"https://github.com/substack/node-falafel/issues"},"bundleDependencies":["esprima"],"_id":"falafel@0.3.1","dist":{"shasum":"f3546748814f7d09543d19f2fb3d6090f136853d","tarball":"http://registry.npmjs.org/falafel/-/falafel-0.3.1.tgz"},"_from":".","_npmVersion":"1.3.0","_npmUser":{"name":"substack","email":"mail@substack.net"},"maintainers":[{"name":"substack","email":"mail@substack.net"}]}},"readme":"# falafel\n\nTransform the [ast](http://en.wikipedia.org/wiki/Abstract_syntax_tree) on a\nrecursive walk.\n\n[![browser support](http://ci.testling.com/substack/node-falafel.png)](http://ci.testling.com/substack/node-falafel)\n\n[![build status](https://secure.travis-ci.org/substack/node-falafel.png)](http://travis-ci.org/substack/node-falafel)\n\nThis module is like [burrito](https://github.com/substack/node-burrito),\nexcept that it uses [esprima](http://esprima.org) instead of\n[uglify](https://github.com/mishoo/UglifyJS)\nfor friendlier-looking ast nodes.\n\n![falafel döner](http://substack.net/images/falafel.png)\n\n# example\n\n## array.js\n\nPut a function wrapper around all array literals.\n\n``` js\nvar falafel = require('falafel');\n\nvar src = '(' + function () {\n    var xs = [ 1, 2, [ 3, 4 ] ];\n    var ys = [ 5, 6 ];\n    console.dir([ xs, ys ]);\n} + ')()';\n\nvar output = falafel(src, function (node) {\n    if (node.type === 'ArrayExpression') {\n        node.update('fn(' + node.source() + ')');\n    }\n});\nconsole.log(output);\n```\n\noutput:\n\n```\n(function () {\n    var xs = fn([ 1, 2, fn([ 3, 4 ]) ]);\n    var ys = fn([ 5, 6 ]);\n    console.dir(fn([ xs, ys ]));\n})()\n```\n\n## custom keyword\n\nCreating custom keywords is super simple!\n\nThis example creates a new `beep` keyword that uppercases its arguments:\n\n``` js\nvar falafel = require('falafel');\nvar src = 'console.log(beep \"boop\", \"BOOP\");';\n\nfunction isKeyword (id) {\n    if (id === 'beep') return true;\n}\n\nvar output = falafel(src, { isKeyword: isKeyword }, function (node) {\n    if (node.type === 'UnaryExpression'\n    && node.keyword === 'beep') {\n        node.update(\n            'String(' + node.argument.source() + ').toUpperCase()'\n        );\n    }\n});\nconsole.log(output);\n```\n\nNow the source string `console.log(beep \"boop\", \"BOOP\");` is converted to:\n\n```\n$ node example/keyword.js\nconsole.log(String(\"boop\").toUpperCase(), \"BOOP\");\n```\n\nwhich we can execute:\n\n```\n$ node example/keyword.js | node\nBOOP BOOP\n```\n\nNeat!\n\n# methods\n\n``` js\nvar falafel = require('falafel')\n```\n\n## falafel(src, opts={}, fn)\n\nTransform the string source `src` with the function `fn`, returning a\nstring-like transformed output object.\n\nFor every node in the ast, `fn(node)` fires. The recursive walk is a\npre-traversal, so children get called before their parents.\n\nPerforming a pre-traversal makes it easier to write nested transforms since\ntransforming parents often requires transforming all its children first.\n\nThe return value is string-like (it defines `.toString()` and `.inspect()`) so\nthat you can call `node.update()` asynchronously after the function has\nreturned and still capture the output.\n\nInstead of passing a `src` you can also use `opts.source`.\n\nAll of the `opts` will be passed directly to esprima except for `'range'` which\nis always turned on because falafel needs it.\n\nSome of the options you might want from esprima includes:\n`'loc'`, `'raw'`, `'comments'`, `'tokens'`, and `'tolerant'`.\n\nfalafel uses a custom patch of esprima with support for an `opts.isKeyword()`\nfunction. When `opts.isKeyword(id)` returns `true`, the string `id` will be\ntreated as a keyword. You can use this behavior to create custom unary\nexpression keywords.\n\nAn `opts.isKeyword(id)` value that is a string will be mapped to existing types.\nThe only currently supported string value is `\"block\"`.\n\n# nodes\n\nAside from the regular [esprima](http://esprima.org) data, you can also call\nsome inserted methods on nodes.\n\nAside from updating the current node, you can also reach into sub-nodes to call\nupdate functions on children from parent nodes.\n\n## node.source()\n\nReturn the source for the given node, including any modifications made to\nchildren nodes.\n\n## node.update(s)\n\nTransform the source for the present node to the string `s`.\n\nNote that in `'ForStatement'` node types, there is an existing subnode called\n`update`. For those nodes all the properties are copied over onto the\n`node.update()` function.\n\n## node.parent\n\nReference to the parent element or `null` at the root element.\n\n# install\n\nWith [npm](http://npmjs.org) do:\n\n```\nnpm install falafel\n```\n\n# license\n\nMIT\n\n","maintainers":[{"name":"substack","email":"mail@substack.net"}],"time":{"modified":"2014-04-30T06:25:14.725Z","created":"2012-04-27T05:10:40.104Z","0.0.0":"2012-04-27T05:10:41.822Z","0.0.1":"2012-04-28T02:23:42.708Z","0.0.2":"2012-05-15T02:27:53.846Z","0.1.0":"2012-06-12T12:31:03.716Z","0.1.1":"2012-08-11T22:32:57.665Z","0.1.2":"2012-08-19T09:03:01.235Z","0.1.3":"2012-08-25T10:32:19.037Z","0.1.4":"2012-11-04T07:01:11.645Z","0.1.5":"2013-02-22T11:38:58.950Z","0.1.6":"2013-02-28T13:02:23.312Z","0.2.0":"2013-03-08T00:56:47.629Z","0.2.1":"2013-03-31T01:25:53.834Z","0.3.0":"2013-07-18T22:45:15.994Z","0.3.1":"2013-07-18T22:48:30.073Z"},"author":{"name":"James Halliday","email":"mail@substack.net","url":"http://substack.net"},"repository":{"type":"git","url":"git://github.com/substack/node-falafel.git"},"users":{"pid":true,"freethenation":true,"chrisdickinson":true,"kastor":true,"mk":true,"benjello":true,"davepoon":true},"keywords":["ast","source","traversal","syntax","tree","burrito"],"bugs":{"url":"https://github.com/substack/node-falafel/issues"},"license":"MIT","readmeFilename":"readme.markdown","_attachments":{},"_etag":"\"4Q8YG6VV6M6JTDTPB81DSSHWP\""}